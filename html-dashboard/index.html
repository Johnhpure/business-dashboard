<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拼好拼 - 业务数据看板</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/animations.css">
    <!-- ECharts 图表库 -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- 字体图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- 动态背景 -->
    <div class="background-animation">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <!-- 主容器 -->
    <div class="dashboard-container">
        <!-- 顶部导航栏 -->
        <header class="dashboard-header glass-card">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    <span>拼好拼数据看板</span>
                </div>
                <div class="real-time-indicator">
                    <div class="pulse-dot"></div>
                    <span>实时数据</span>
                </div>
            </div>
            <div class="header-center">
                <div class="time-filter">
                    <select id="timeRange" class="glass-select">
                        <option value="realtime">实时</option>
                        <option value="today">今日</option>
                        <option value="week">本周</option>
                        <option value="month" selected>本月</option>
                        <option value="quarter">本季度</option>
                        <option value="year">本年</option>
                    </select>
                </div>
            </div>
            <div class="header-right">
                <div class="refresh-control">
                    <button class="glass-button" id="refreshBtn">
                        <i class="fas fa-sync-alt"></i>
                        刷新
                    </button>
                </div>
                <div class="user-info">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <span>管理员</span>
                </div>
            </div>
        </header>

        <!-- 主内容区域 -->
        <main class="dashboard-main">
            <!-- 左侧筛选面板 -->
            <aside class="filter-panel glass-card">
                <div class="panel-header">
                    <h3><i class="fas fa-filter"></i> 数据筛选</h3>
                    <button class="collapse-btn" id="collapseFilter">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                </div>

                <div class="filter-content">
                    <!-- 地域筛选 -->
                    <div class="filter-group">
                        <h4><i class="fas fa-map-marker-alt"></i> 地域筛选</h4>
                        <div class="region-filter">
                            <select id="provinceSelect" class="glass-select">
                                <option value="">全国</option>
                                <option value="sichuan">四川省</option>
                                <option value="guangdong">广东省</option>
                                <option value="beijing">北京市</option>
                                <option value="shanghai">上海市</option>
                            </select>
                            <select id="citySelect" class="glass-select" disabled>
                                <option value="">选择城市</option>
                            </select>
                            <select id="districtSelect" class="glass-select" disabled>
                                <option value="">选择区县</option>
                            </select>
                        </div>
                    </div>

                    <!-- 角色筛选 -->
                    <div class="filter-group">
                        <h4><i class="fas fa-users"></i> 角色筛选</h4>
                        <div class="role-filter">
                            <label class="checkbox-label">
                                <input type="checkbox" value="partners" checked>
                                <span class="checkmark"></span>
                                合伙人
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" value="business" checked>
                                <span class="checkmark"></span>
                                商务
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" value="stores" checked>
                                <span class="checkmark"></span>
                                商户
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" value="users" checked>
                                <span class="checkmark"></span>
                                用户
                            </label>
                        </div>
                    </div>

                    <!-- 分红轮次筛选 -->
                    <div class="filter-group">
                        <h4><i class="fas fa-coins"></i> 分红轮次</h4>
                        <div class="round-filter">
                            <div class="round-range">
                                <input type="range" id="roundRange" min="1" max="50" value="25" class="glass-range">
                                <div class="range-labels">
                                    <span>第1轮</span>
                                    <span id="currentRound">第25轮</span>
                                    <span>第50轮</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- 右侧内容区域 -->
            <div class="content-area">
                <!-- KPI概览区域 -->
                <section class="kpi-overview">
                    <div class="kpi-grid">
                        <div class="kpi-card glass-card" data-kpi="revenue">
                            <div class="kpi-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <span class="number">0</span>
                                    <span class="unit">元</span>
                                </div>
                                <div class="kpi-label">总交易金额</div>
                                <div class="kpi-trend positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>+15.8%</span>
                                </div>
                            </div>
                        </div>

                        <div class="kpi-card glass-card" data-kpi="stores">
                            <div class="kpi-icon">
                                <i class="fas fa-store"></i>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <span class="number">0</span>
                                    <span class="unit">家</span>
                                </div>
                                <div class="kpi-label">活跃商户</div>
                                <div class="kpi-trend positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>+8.3%</span>
                                </div>
                            </div>
                        </div>

                        <div class="kpi-card glass-card" data-kpi="users">
                            <div class="kpi-icon">
                                <i class="fas fa-user-friends"></i>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <span class="number">0</span>
                                    <span class="unit">人</span>
                                </div>
                                <div class="kpi-label">活跃用户</div>
                                <div class="kpi-trend positive">
                                    <i class="fas fa-arrow-up"></i>
                                    <span>+23.7%</span>
                                </div>
                            </div>
                        </div>

                        <div class="kpi-card glass-card" data-kpi="dividend">
                            <div class="kpi-icon">
                                <i class="fas fa-coins"></i>
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <span class="number">0</span>
                                    <span class="unit">元</span>
                                </div>
                                <div class="kpi-label">分红池余额</div>
                                <div class="kpi-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 73%"></div>
                                    </div>
                                    <span class="progress-text">距离下次分红 73%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 地图和图表区域 -->
                <section class="visualization-section">
                    <div class="viz-grid">
                        <!-- 地图可视化 -->
                        <div class="map-container glass-card">
                            <div class="card-header">
                                <h3><i class="fas fa-map"></i> 全国业务分布</h3>
                                <div class="card-controls">
                                    <button class="control-btn active" data-map-type="revenue">
                                        <i class="fas fa-dollar-sign"></i> 收入
                                    </button>
                                    <button class="control-btn" data-map-type="stores">
                                        <i class="fas fa-store"></i> 商户
                                    </button>
                                    <button class="control-btn" data-map-type="users">
                                        <i class="fas fa-users"></i> 用户
                                    </button>
                                </div>
                            </div>
                            <div class="map-chart" id="chinaMap"></div>
                        </div>

                        <!-- 分红轮次进度 -->
                        <div class="dividend-progress glass-card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-pie"></i> 分红轮次进度</h3>
                            </div>
                            <div class="dividend-content">
                                <div class="current-round">
                                    <div class="round-number">第 <span class="highlight">25</span> 轮</div>
                                    <div class="round-status">进行中</div>
                                </div>
                                <div class="progress-circle">
                                    <svg class="progress-ring" width="120" height="120">
                                        <circle class="progress-ring-circle" stroke="#00d4ff" stroke-width="8"
                                            fill="transparent" r="52" cx="60" cy="60" />
                                        <circle class="progress-ring-progress" stroke="#ff6b6b" stroke-width="8"
                                            fill="transparent" r="52" cx="60" cy="60"
                                            style="stroke-dasharray: 326.73; stroke-dashoffset: 88.22;" />
                                    </svg>
                                    <div class="progress-text">73%</div>
                                </div>
                                <div class="dividend-info">
                                    <div class="info-item">
                                        <span class="label">预计分红时间</span>
                                        <span class="value">2天后</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">预计分红金额</span>
                                        <span class="value">¥680,000</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 图表分析区域 -->
                <section class="charts-section">
                    <div class="charts-grid">
                        <!-- 收入趋势图 -->
                        <div class="chart-container glass-card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-line"></i> 收入趋势分析</h3>
                                <div class="chart-controls">
                                    <button class="control-btn active" data-period="7d">7天</button>
                                    <button class="control-btn" data-period="30d">30天</button>
                                    <button class="control-btn" data-period="90d">90天</button>
                                </div>
                            </div>
                            <div class="chart" id="revenueChart"></div>
                        </div>

                        <!-- 角色分红分布 -->
                        <div class="chart-container glass-card">
                            <div class="card-header">
                                <h3><i class="fas fa-chart-pie"></i> 角色分红分布</h3>
                            </div>
                            <div class="chart" id="dividendChart"></div>
                        </div>
                    </div>
                </section>

                <!-- 排行榜区域 -->
                <section class="ranking-section">
                    <div class="ranking-grid">
                        <!-- 合伙人收益排行 -->
                        <div class="ranking-card glass-card">
                            <div class="card-header">
                                <h3><i class="fas fa-trophy"></i> 合伙人收益排行</h3>
                                <div class="ranking-controls">
                                    <select class="glass-select small">
                                        <option value="month">本月</option>
                                        <option value="quarter">本季度</option>
                                        <option value="year">本年</option>
                                    </select>
                                </div>
                            </div>
                            <div class="ranking-list" id="partnerRanking">
                                <!-- 排行榜内容将通过JavaScript动态生成 -->
                            </div>
                        </div>

                        <!-- 商户收益排行 -->
                        <div class="ranking-card glass-card">
                            <div class="card-header">
                                <h3><i class="fas fa-medal"></i> 商户收益排行</h3>
                                <div class="ranking-controls">
                                    <select class="glass-select small">
                                        <option value="month">本月</option>
                                        <option value="quarter">本季度</option>
                                        <option value="year">本年</option>
                                    </select>
                                </div>
                            </div>
                            <div class="ranking-list" id="storeRanking">
                                <!-- 排行榜内容将通过JavaScript动态生成 -->
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- JavaScript 模块 -->
    <script type="module">
        // 确保模块正确加载
        console.log('开始加载模块...');

        try {
            import('./js/main.js').then(module => {
                console.log('主模块加载成功');
            }).catch(error => {
                console.error('主模块加载失败:', error);

                // 如果模块加载失败，显示基本数据
                document.addEventListener('DOMContentLoaded', () => {
                    console.log('使用备用数据显示方案');

                    // 直接设置KPI数据
                    const kpiData = [
                        { selector: '[data-kpi="revenue"] .number', value: '1,258.0w' },
                        { selector: '[data-kpi="stores"] .number', value: '8,642' },
                        { selector: '[data-kpi="users"] .number', value: '15.7w' },
                        { selector: '[data-kpi="dividend"] .number', value: '251.6w' }
                    ];

                    kpiData.forEach(item => {
                        const element = document.querySelector(item.selector);
                        if (element) {
                            element.textContent = item.value;
                            console.log(`设置 ${item.selector} 为 ${item.value}`);
                        } else {
                            console.log(`未找到元素: ${item.selector}`);
                        }
                    });

                    // 显示排行榜数据
                    const partnerRanking = document.getElementById('partnerRanking');
                    const storeRanking = document.getElementById('storeRanking');

                    if (partnerRanking) {
                        partnerRanking.innerHTML = `
                            <div class="ranking-item">
                                <div class="ranking-number top-1">1</div>
                                <div class="ranking-info">
                                    <div class="ranking-name">四川省5GP合伙人1</div>
                                    <div class="ranking-details">
                                        <span>四川省</span>
                                        <span>85个</span>
                                    </div>
                                </div>
                                <div class="ranking-value">
                                    <div class="ranking-amount">¥458,000</div>
                                    <div class="ranking-change positive">
                                        <i class="fas fa-arrow-up"></i>
                                        15.8%
                                    </div>
                                </div>
                            </div>
                            <div class="ranking-item">
                                <div class="ranking-number top-2">2</div>
                                <div class="ranking-info">
                                    <div class="ranking-name">广东省5GP合伙人1</div>
                                    <div class="ranking-details">
                                        <span>广东省</span>
                                        <span>92个</span>
                                    </div>
                                </div>
                                <div class="ranking-value">
                                    <div class="ranking-amount">¥423,000</div>
                                    <div class="ranking-change positive">
                                        <i class="fas fa-arrow-up"></i>
                                        12.3%
                                    </div>
                                </div>
                            </div>
                            <div class="ranking-item">
                                <div class="ranking-number top-3">3</div>
                                <div class="ranking-info">
                                    <div class="ranking-name">北京市5GP合伙人1</div>
                                    <div class="ranking-details">
                                        <span>北京市</span>
                                        <span>76个</span>
                                    </div>
                                </div>
                                <div class="ranking-value">
                                    <div class="ranking-amount">¥398,000</div>
                                    <div class="ranking-change positive">
                                        <i class="fas fa-arrow-up"></i>
                                        18.7%
                                    </div>
                                </div>
                            </div>
                        `;
                    }

                    if (storeRanking) {
                        storeRanking.innerHTML = `
                            <div class="ranking-item">
                                <div class="ranking-number top-1">1</div>
                                <div class="ranking-info">
                                    <div class="ranking-name">老王餐厅</div>
                                    <div class="ranking-details">
                                        <span>餐饮</span>
                                        <span>1个</span>
                                    </div>
                                </div>
                                <div class="ranking-value">
                                    <div class="ranking-amount">¥125,000</div>
                                    <div class="ranking-change positive">
                                        <i class="fas fa-arrow-up"></i>
                                        25.6%
                                    </div>
                                </div>
                            </div>
                            <div class="ranking-item">
                                <div class="ranking-number top-2">2</div>
                                <div class="ranking-info">
                                    <div class="ranking-name">小李超市</div>
                                    <div class="ranking-details">
                                        <span>零售</span>
                                        <span>1个</span>
                                    </div>
                                </div>
                                <div class="ranking-value">
                                    <div class="ranking-amount">¥98,000</div>
                                    <div class="ranking-change positive">
                                        <i class="fas fa-arrow-up"></i>
                                        18.9%
                                    </div>
                                </div>
                            </div>
                            <div class="ranking-item">
                                <div class="ranking-number top-3">3</div>
                                <div class="ranking-info">
                                    <div class="ranking-name">阿华理发店</div>
                                    <div class="ranking-details">
                                        <span>服务</span>
                                        <span>1个</span>
                                    </div>
                                </div>
                                <div class="ranking-value">
                                    <div class="ranking-amount">¥76,000</div>
                                    <div class="ranking-change positive">
                                        <i class="fas fa-arrow-up"></i>
                                        22.1%
                                    </div>
                                </div>
                            </div>
                        `;
                    }

                    console.log('备用数据显示完成');
                });
            });
        } catch (error) {
            console.error('脚本执行失败:', error);
        }
    </script>
</body>

</html>